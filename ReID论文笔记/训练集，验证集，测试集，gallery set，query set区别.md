# 训练集，验证集，测试集，gallery set，query set区别

---

### **1. 训练集（Training Set）**
- **作用**：用于模型的训练，通过优化参数使模型学习数据中的模式和特征。
- **特点**：
  - 是模型直接学习的“教材”。
  - 通常占数据集的 60%~80%。
  - 需要足够大以覆盖数据的多样性。
- **注意**：模型可能对训练集过拟合（过度记忆数据），因此需要其他数据集验证泛化能力。

---

### **2. 验证集（Validation Set）**
- **作用**：用于调整超参数（如学习率、网络层数等）和选择最佳模型，防止过拟合训练集。
- **特点**：
  - 不参与训练，仅在训练过程中评估模型性能。
  - 通常占数据集的 10%~20%。
  - 在交叉验证（Cross-Validation）中，验证集可能被多次动态划分。
- **注意**：如果直接用测试集调参，会导致模型对测试集过拟合，失去评估意义。

---

### **3. 测试集（Test Set）**
- **作用**：用于最终评估模型的泛化能力，反映模型在真实场景中的表现。
- **特点**：
  - 仅在模型训练和调参完成后使用，**只能使用一次**。
  - 通常占数据集的 10%~20%。
  - 必须与训练集、验证集无重叠。
- **注意**：测试集的结果是论文或报告中汇报的核心指标（如准确率、F1 分数等）。

---

### **4. Gallery Set 和 Query Set**
- **应用场景**：主要在图像检索（Image Retrieval）、人脸识别或行人重识别（ReID）等任务中使用。
- **作用**：
  - **Gallery Set**（底库/候选集）：相当于一个数据库，存储已知类别的样本（如图片或特征向量）。例如，人脸识别系统中的注册人脸库。
  - **Query Set**（查询集）：包含待查询的样本，系统需要从 Gallery Set 中找到与 Query 最匹配的样本。
- **特点**：
  - 两者通常属于测试阶段的数据，但划分方式与训练集无关。
  - 在测试时，模型需要计算 Query 与 Gallery 中所有样本的相似度（如余弦相似度），并返回排名结果。
- **示例**：
  - 在人脸识别中：Gallery Set 是已知身份的 1000 张人脸，Query Set 是 100 张待识别的人脸。
  - 在电商检索中：Gallery Set 是所有商品图片，Query Set 是用户上传的搜索图片。

---

### **关键区别总结**
| **数据集**  | **用途**           | **阶段** | **特点**                         |
| ----------- | ------------------ | -------- | -------------------------------- |
| 训练集      | 模型训练           | 训练阶段 | 直接参与参数优化                 |
| 验证集      | 调参和模型选择     | 训练阶段 | 不参与训练，但影响超参数选择     |
| 测试集      | 最终评估           | 测试阶段 | 仅使用一次，无任何参与训练或调参 |
| Gallery Set | 检索任务的候选库   | 测试阶段 | 存储已知样本，用于匹配 Query     |
| Query Set   | 检索任务的查询样本 | 测试阶段 | 待查询的样本，与 Gallery 对比    |

---

### **常见误区**
1. **用测试集调参**：会导致模型在测试集上过拟合，评估结果不真实。
2. **Gallery/Query 与训练集重叠**：在检索任务中，Gallery 和 Query 必须与训练集独立，否则可能泄露数据分布。
3. **混淆验证集和测试集**：验证集用于开发模型，测试集用于最终汇报结果，二者不可混用。

---

### **示例场景**
- **图像分类任务**：
  - 数据划分：60% 训练集，20% 验证集，20% 测试集。
  - 模型在训练集上学习，通过验证集选择最佳 epoch，最终用测试集评估准确率。
- **人脸检索任务**：
  - 训练阶段：使用独立的训练集和验证集训练模型。
  - 测试阶段：Gallery Set 包含注册人脸，Query Set 是待识别的人脸，模型计算相似度并返回结果。

通过合理划分数据集，可以更科学地评估模型性能，确保其在实际应用中的可靠性。